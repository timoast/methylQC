---
title: "methylQC Report"
output: html_document
params:
  data: NA
---

```{r eval = FALSE, echo = FALSE}
# For PDF output, change the header to have "output: pdf_document".
#
# Note that due to an issue in rmarkdown, the default value of a parameter in
# the header cannot be `NULL`, so I used a default of `NA` for the default value
# of `n`.
```

```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(ggplot2)
library(dplyr)
library(methylQC)
```


# Coverage  

## Genome browser view

`r input$chrom` between `r rv$start` and `r rv$end`

```{r browser, echo=FALSE, message=FALSE, warning=FALSE}
plotBrowser(rv$data, start = rv$start, stop = rv$end)
```

## Covered cytosines

```{r cytosines, echo=FALSE, message=FALSE, warning=FALSE}
plotSurvival(params$data, species = "arabidopsis", chromosome = "all")
```

## Summary statistics

```{r, echo=FALSE, message=FALSE, warning=FALSE}
methylomeStats(params$data) %>%
  knitr::kable()
```

# Non-conversion rate

## Lambda genome coverage

```{r lambda, echo=FALSE, message=FALSE, warning=FALSE}
l <- subset(params$data, params$data$chr == "L")
ggplot(l, aes(depth)) + geom_histogram(fill = "darkgreen", color="black") +
      theme_bw() + ggtitle("Lambda chromosome sequencing depth")
```

## Non-conversion rates

```{r conversion, echo=FALSE, message=FALSE, warning=FALSE}
nonConversion(l) %>%
  knitr::kable()
```

