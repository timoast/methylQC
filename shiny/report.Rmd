---
title: "methylQC Report"
output: html_document
params:
  data: NA
  l: NA
---

```{r eval = FALSE, echo = FALSE}
# For PDF output, change the header to have "output: pdf_document".
#
# Note that due to an issue in rmarkdown, the default value of a parameter in
# the header cannot be `NULL`, so I used a default of `NA` for the default value
# of `n`.
```

```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(ggplot2)
library(dplyr)
library(methylQC)
```


## Coverage  

`r input$chrom` between `r rv$start` and `r rv$end`

```{r browser, echo=FALSE, message=FALSE, warning=FALSE}
plotBrowser(rv$data, start = rv$start, stop = rv$end)
```

## Covered cytosines

```{r cytosines, echo=FALSE, message=FALSE, warning=FALSE}
plotSurvival(params$data, species = "arabidopsis", chromosome = "all")
```

## Non-conversion rate

```{r lambda, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(params$l, aes(depth)) + geom_histogram(fill = "darkgreen", color="black") +
      theme_bw() + ggtitle("Lambda chromosome sequencing depth")
```

```{r conversion, echo=FALSE, message=FALSE, warning=FALSE}
params$l %>%
      group_by(context) %>%
      mutate(`Non-conversion rate` = sum(mC) / sum(depth) * 100) %>%
      select(context, `Non-conversion rate`) %>%
      unique() %>%
      filter(context %in% c("CG", "CHG", "CHH")) %>%
      arrange(context) %>%
  knitr::kable()
```

